>  본 포스팅은 [Probabilistic CCA with implicit distributions](https://arxiv.org/pdf/1907.02345.pdf)에 대한 간단한 리뷰와 python 코드를 작성한 글입니다. 정확한 내용은 반드시 원문을 참조해 주시기 바랍니다.
>  1편: 논문 리뷰
>  2편: python 코드

## 0. setting
```python
import tensorflow as tf
import tensorflow.keras as K
from tensorflow.keras import layers
from tensorflow.keras import preprocessing
# from tensorflow.keras.models import model_from_json
print('TensorFlow version:', tf.__version__)
print('즉시 실행 모드:', tf.executing_eagerly())
print(tf.test.is_gpu_available(
      cuda_only=False,
      min_cuda_compute_capability=None
))
from tensorflow.python.client import device_lib
print(device_lib.list_local_devices())
tf.debugging.set_log_device_placement(False)
```
```

```

```python
import numpy as np
import matplotlib.pylab as plt 
import os
os.chdir('/home/jeon/Desktop/an/cca')
print('current directory:', os.getcwd())
#%%
(train_images, train_labels), (test_images, test_labels) = tf.keras.datasets.mnist.load_data() 
print(train_images.shape)
# train_images = train_images[:, :, :, np.newaxis]
img_shape = train_images.shape[1:]
x_shape = (img_shape[0], int(img_shape[1]/2))
y_shape = (img_shape[0], int(img_shape[1]/2))
xy_shape = img_shape
```

```python
latent_dim = 100
```

```python
def build_encoder():
    x = layers.Input(shape=x_shape)   
    y = layers.Input(shape=y_shape)   
    xy = layers.Input(shape=xy_shape)   
    
    hx = layers.Flatten()(x)
    hy = layers.Flatten()(y)
    hxy = layers.Flatten()(xy)
    
    hx = layers.Dense(256)(hx)
    hx = layers.LeakyReLU(alpha=0.2)(hx)
    hx = layers.Dense(256)(hx)
    hx = layers.LeakyReLU(alpha=0.2)(hx)
    
    hy = layers.Dense(256)(hy)
    hy = layers.LeakyReLU(alpha=0.2)(hy)
    hy = layers.Dense(256)(hy)
    hy = layers.LeakyReLU(alpha=0.2)(hy)
    
    hxy = layers.Dense(256)(hxy)
    hxy = layers.LeakyReLU(alpha=0.2)(hxy)
    hxy = layers.Dense(256)(hxy)
    hxy = layers.LeakyReLU(alpha=0.2)(hxy)
    
    zx = layers.Dense(latent_dim)(hx)
    zy = layers.Dense(latent_dim)(hy)
    zxy = layers.Dense(latent_dim)(hxy)
    
    return K.models.Model([x, y, xy], [zx, zy, zxy])
```


## 논문
SHI, Yaxin, et al. Probabilistic CCA with Implicit Distributions. _arXiv preprint arXiv:1907.02345_, 2019.

<!--stackedit_data:
eyJoaXN0b3J5IjpbMjA1NDU4MDE2OF19
-->